<!DOCTYPE html><html lang="en">
<head>
  <title>Cartogramener</title>
  <link rel="stylesheet" href="bootstrap.min.css">
  <link rel="stylesheet" href="cartogram.css">
  <style>
  svg { border: 1px solid #ccc; }
  path { stroke: #fff; }
  </style>
</head><body>

<div class="header">
  <div class="container">
    <h1>Cartogramener</h1>
    <a href="http://gramener.com/" class="gramenerlogo">by Gramener</a>
  </div>
</div>

<div class="container">
  <form class="form-inline">
    <select name="map">
      <optgroup label="Map">
        <option>India</option>
        <option>Andhra Pradesh</option>
        <option>...</option>
      </optgroup>
    </select>
    <select name="division" class="input-medium">
      <optgroup label="Division">
        <option>District</option>
        <option>Parliamentary</option>
        <option>Assembly</option>
      </optgroup>
    </select>
    <select name="cartogram" class="input-medium">
      <optgroup label="Cartogram">
        <option>Stretch</option>
        <option>Circles (Dorling)</option>
        <option>None</option>
      </optgroup>
    </select>
    <select name="size" class="input-medium">
      <optgroup label="Size">
        <option>...</option>
      </optgroup>
    </select>
    <select name="size" class="input-medium">
      <optgroup label="Size">
        <option>...</option>
      </optgroup>
    </select>
    <button class="btn">Upload</button>
  </form>
  <svg class="carto" xmlns="http://www.w3.org/2000/svg" width="940" height="700"></svg>
  <p>Right now, none of the functionality works. But eventually, we'll get it all going.</p>
</div>

<!-- cartogram.js does not work with d3.v3 -->
<script src="d3.v2.min.js"></script>
<script src="topojson.v0.min.js"></script>
<script src="cartogram.js"></script>
<script>
  d3.json('S01_PC.topo.json', function(json) {
    var object = d3.values(json.objects)[0];
    var shape = topojson.object(json, object);
    var bounds = d3.geo.bounds(shape);
    var svg = d3.select('svg.carto');
    var projection = d3.geo.albers()
        .translate([parseInt(svg.attr('width'))/2, parseInt(svg.attr('height'))/2])
        .parallels([bounds[0][1], bounds[1][1]])
        .origin([(bounds[0][0] + bounds[1][0])/2, (bounds[0][1] + bounds[1][1])/2])
        // TODO: determine the scale automatically
        .scale(5500);
    var cartogram = d3.cartogram()
        .projection(projection)
        .value(function(d) {
            return Math.exp(1 + Math.random());
        });
    var paths = svg.selectAll('path')
        .data(cartogram(json, object.geometries).features);
    paths.enter().append('path')
        .attr('d', cartogram.path);
  });
</script>
</body></html>
